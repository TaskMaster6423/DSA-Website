:root {
    --bg-color: #1e1e2e;
    --card-bg: #2b2b40;
    --primary: #89b4fa;
    --fixed: #313244;      /* Darker background for pre-filled */
    --try: #f9e2af;        /* Yellow for attempting */
    --safe: #a6e3a1;       /* Green for valid placement */
    --backtrack: #f38ba8;  /* Red for removing */
    --text: #cdd6f4;
    --muted: #a6adc8;
    --border: #45475a;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text);
    margin: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

h1 { margin-bottom: 20px; color: var(--primary); }

.container { width: 95%; max-width: 900px; display: flex; flex-direction: column; gap: 20px; }

/* Controls */
.controls-card {
    background-color: var(--card-bg);
    padding: 20px;
    border-radius: 12px;
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: flex-end;
    justify-content: center;
}

.input-group { display: flex; flex-direction: column; gap: 5px; }
label { font-size: 0.9rem; color: var(--muted); }
select { padding: 8px; border-radius: 6px; background: #181825; color: white; border: 1px solid var(--border); }

button {
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    color: #181825;
}
.btn-primary { background-color: var(--primary); }
.btn-step { background-color: var(--try); }
.btn-stop { background-color: var(--backtrack); }
.btn-reset { background-color: var(--muted); }
.btn-rand { background-color: #cba6f7; }

.speed-control { display: flex; flex-direction: column; align-items: center; min-width: 120px; }

/* Legend */
.legend { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
.legend-item { display: flex; align-items: center; gap: 5px; font-size: 0.9rem; }
.legend-box { width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #1e1e2e; border-radius: 4px; }
.legend-box.fixed { background: var(--fixed); color: var(--text); border: 1px solid var(--muted); }
.legend-box.try { background: var(--try); }
.legend-box.safe { background: var(--safe); }
.legend-box.backtrack { background: var(--backtrack); }

/* Sudoku Grid */
.sudoku-grid {
    display: grid;
    grid-template-columns: repeat(9, 1fr);
    gap: 1px;
    background-color: var(--border);
    border: 4px solid var(--text);
    margin: 0 auto;
    width: 100%;
    max-width: 450px; /* Limit size for look */
    aspect-ratio: 1/1;
}

.cell {
    background-color: #181825;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--text);
    position: relative;
    cursor: default;
}

/* Thicker borders for 3x3 subgrids */
.cell:nth-child(3n) { border-right: 2px solid var(--text); }
.cell:nth-child(9n) { border-right: none; } /* End of row */
.cell:nth-child(n+19):nth-child(-n+27), 
.cell:nth-child(n+46):nth-child(-n+54) { 
    border-bottom: 2px solid var(--text); 
}

/* Cell States */
.cell.fixed { background-color: var(--fixed); color: #a6adc8; }
.cell.try { background-color: var(--try); color: #1e1e2e; }
.cell.safe { background-color: var(--safe); color: #1e1e2e; transition: background-color 0.2s; }
.cell.backtrack { background-color: var(--backtrack); color: #1e1e2e; animation: flashRed 0.3s; }

@keyframes flashRed {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Logs & Code */
.log-section {
    background-color: #11111b;
    padding: 15px;
    border-radius: 8px;
    font-family: 'Courier New', monospace;
    min-height: 40px;
    color: var(--text);
    border-left: 4px solid var(--primary);
}

.code-section { background-color: var(--card-bg); border-radius: 12px; overflow: hidden; margin-top: 20px;}
.tabs { display: flex; background-color: #181825; }
.tab-btn { padding: 15px 25px; background: none; border: none; color: var(--muted); cursor: pointer; flex: 1; }
.tab-btn.active { color: var(--primary); border-bottom: 3px solid var(--primary); background-color: rgba(137, 180, 250, 0.1); }
.code-content { padding: 20px; display: none; }
.code-content.active { display: block; }
pre { margin: 0; white-space: pre-wrap; color: #cdd6f4; font-family: 'Courier New', monospace; background: #11111b; padding: 15px; }